version: '3'
services:
    eureka-service:
        build:
            context: Eureka-server
            dockerfile: Dockerfile
        ports:
            - "8761:8761"
        restart: always
        networks:
            - eureka-network

    main-service:
        build:
            context: Service-master
            dockerfile: Dockerfile
        ports:
            - "9090:9090"
        depends_on:
            - accounts-serivce
            - products-service
            - baskets-service
            - orders-service
            - eureka-service
        environment:
            EUREKA_ADDR: eureka-service
        networks:
            - eureka-network

    accounts-serivce:
        build:
            context: Accounts-master
            dockerfile: Dockerfile
        ports:
            - "8081:8081"
        restart: always
        depends_on:
            - mysql_accounts
            - eureka-service
        environment:
            RDS_HOSTNAME: mysql_accounts
            RDS_PORT: 3306
            RDS_DB_NAME: db_accounts
            RDS_USERNAME: springuser
            RDS_PASSWORD: Password
            EUREKA_ADDR: eureka-service

        networks:
            - accounts-service-network
            - eureka-network

    products-service:
        build:
            context: Products-master
            dockerfile: Dockerfile
        ports:
            - "8084:8084"
        restart: always
        depends_on:
            - mysql_products
            - eureka-service
        environment:
            RDS_HOSTNAME: mysql_products
            RDS_PORT: 3306
            RDS_DB_NAME: db_products
            RDS_USERNAME: springuser
            RDS_PASSWORD: Password
            EUREKA_ADDR: eureka-service

        networks:
            - products-service-network
            - eureka-network

    baskets-service:
        build:
            context: Baskets-master
            dockerfile: Dockerfile
        ports:
            - "8082:8082"
        restart: always
        depends_on:
            - mysql_baskets
        environment:
            RDS_HOSTNAME: mysql_baskets
            RDS_PORT: 3306
            RDS_DB_NAME: db_baskets
            RDS_USERNAME: springuser
            RDS_PASSWORD: Password
            EUREKA_ADDR: eureka-service

        networks:
            - baskets-service-network
            - eureka-network

    orders-service:
        build:
            context: Orders-master
            dockerfile: Dockerfile
        ports:
            - "8083:8083"
        restart: always
        depends_on:
            - mysql_orders
        environment:
            RDS_HOSTNAME: mysql_orders
            RDS_PORT: 3306
            RDS_DB_NAME: db_orders
            RDS_USERNAME: springuser
            RDS_PASSWORD: Password
            EUREKA_ADDR: eureka-service

        networks:
            - orders-service-network
            - eureka-network

    mysql_accounts:
        image: mysql:5.7
        environment:
            MYSQL_ROOT_PASSWORD: Password
            MYSQL_USER: springuser
            MYSQL_PASSWORD: Password
            MYSQL_DATABASE: db_accounts

        container_name: mysql_accounts
        restart: always
        ports:
            - "3307:3306"
        volumes:
            - mysql-dbaccounts-volume:/var/lib/mysql
        networks:
            - accounts-service-network

    mysql_products:
        image: mysql:5.7
        environment:
            MYSQL_ROOT_PASSWORD: Password
            MYSQL_USER: springuser
            MYSQL_PASSWORD: Password
            MYSQL_DATABASE: db_products
        container_name: mysql_products
        restart: always
        ports:
            - "3308:3306"
        volumes:
            - mysql-dbproducts-volume:/var/lib/mysql
        networks:
            - products-service-network

    mysql_baskets:
        image: mysql:5.7
        environment:
            MYSQL_ROOT_PASSWORD: Password
            MYSQL_USER: springuser
            MYSQL_PASSWORD: Password
            MYSQL_DATABASE: db_baskets
        container_name: 'mysql_baskets'
        restart: always
        ports:
            - "3309:3306"
        volumes:
            - mysql-dbbaskets-volume:/var/lib/mysql
        networks:
            - baskets-service-network

    mysql_orders:
        image: mysql:5.7
        environment:
            MYSQL_ROOT_PASSWORD: Password
            MYSQL_USER: springuser
            MYSQL_PASSWORD: Password
            MYSQL_DATABASE: db_orders
        container_name: 'mysql_orders'
        restart: always
        ports:
            - 3310:3306
        volumes:
            - mysql-dborders-volume:/var/lib/mysql
        networks:
            - orders-service-network

volumes:
    mysql-dbaccounts-volume:
    mysql-dbproducts-volume:
    mysql-dbbaskets-volume:
    mysql-dborders-volume:

networks:
    accounts-service-network:
    products-service-network:
    baskets-service-network:
    orders-service-network:
    eureka-network:


    


